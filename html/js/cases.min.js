let caseData,openCasesDataArray,closedCasesDataArray;document.addEventListener("DOMContentLoaded",()=>{initCasesTable(),initOpenCaseFunctions()});const open_case_ids=[];let open_cases_container,open_cases_tab_button,table;function initOpenCaseFunctions(){open_cases_container=document.querySelector(".open-cases-container"),open_cases_tab_button=document.querySelector("[data-bs-target='#openCases']")}async function initCasesTable(){try{const columnResponse=await axios.get("lib/php/data/cases_columns_load.php"),columnResponseData=columnResponse.data,caseDataResponse=await axios.get("lib/php/data/cases_load.php");caseData=caseDataResponse.data.aaData;let table=new Table({columns:columnResponseData.aoColumns,data:caseData,containerId:"#table_cases",facets:[{label:"Open Cases",value:"open",field:"date_close",filter:item=>!item.date_close,default:!0},{label:"Closed Cases",value:"closed",field:"date_close",filter:item=>item.date_close},{label:"All Cases",value:"all",field:"date_close",filter:()=>!0}]})}catch(error){console.log(error)}}function filter(e=null){}function search(e){const keyword=e.target.value;table.search(keyword),table.draw()}function searchColumn(e,columnNumber){table.column(columnNumber).search(e.target.value),table.draw()}function filterDateColumn(id,columnNumber,selectValue){}function toggleCasesAdvancedSearch(){this.classList.toggle("advanced_search--open"),document.querySelector(".advanced-search__fields").classList.toggle("advanced-search__fields--open")}function applyColumnChanges(e){const select__list=document.querySelector(".select__list"),select__inputs=select__list.querySelectorAll("input");for(let i=0;i<select__inputs.length;i++)select__inputs[i].checked?table.column(i).visible(!0):table.column(i).visible(!1);table.draw(),setAdvancedSearchFields();const id=e.target.dataset.select,options=document.querySelector(id);options.classList.toggle("closed")}function resetColumnSelectInputs(){const select__list=document.querySelector(".select__list"),select__inputs=select__list.querySelectorAll("input");visibleColumns.forEach(column=>{select__inputs[column].checked=!0}),hiddenColumns.forEach(column=>{select__inputs[column].checked=!1})}function resetTable(){table.order([0,"asc"]),visibleColumns.forEach(column=>{table.column(column).visible(!0)}),hiddenColumns.forEach(column=>{table.column(column).visible(!1)});const cases_search=document.querySelector("#cases_search");cases_search.value="",search({target:cases_search}),table.searchPanes.clearSelections(),resetColumnSelectInputs(),table.draw()}function setAdvancedSearchFields(){const container=document.querySelector(".advanced-search__fields");container.innerHTML=null;const columns=document.querySelectorAll(".select__list input");columns.forEach(column=>{if(column.checked){let wrapper=document.createElement("div");wrapper.classList.add("advanced-search__element");let input=document.createElement("input"),label=document.createElement("label");if(label.htmlFor=column.dataset.id,label.innerText=column.name,input.id=column.dataset.id,input.type=column.dataset.type,input.classList.add("advanced-search__input"),"date"===input.type){let div=document.createElement("div");div.classList.add("advanced-search__select");let select=document.createElement("select"),greaterThan=document.createElement("option");greaterThan.innerText=">",greaterThan.value=">";let lessThan=document.createElement("option");lessThan.innerText="<",lessThan.value="<";let equalTo=document.createElement("option");equalTo.innerText="=",equalTo.value="=",select.appendChild(greaterThan),select.appendChild(lessThan),select.appendChild(equalTo),div.appendChild(label),div.appendChild(select),div.appendChild(input),container.append(div),input.addEventListener("change",e=>{filterDateColumn(column.dataset.id,column.id,select.value),table.draw()}),select.addEventListener("change",e=>{filterDateColumn(column.dataset.id,column.id,e.target.value),table.draw()})}else wrapper.appendChild(label),wrapper.appendChild(input),container.append(wrapper),input.addEventListener("keyup",e=>searchColumn(e,column.id)),input.addEventListener("keydown",e=>searchColumn(e,column.id))}})}filter();const cases_search=document.querySelector("#cases_search"),cases_select=document.querySelector("#cases_select"),cases_column_select=document.querySelector("#columnsSelectButton"),cases_reset=document.querySelector(".cases__reset"),advanced_search=document.querySelector(".advanced_search p");function openCase(){var data=table.row(this).data();openCase(data[0])}function openCase(id){if(!open_case_ids.includes(id)){open_case_ids.push(id);const p=document.createElement("p");p.innerText=id,open_cases_container.appendChild(p)}open_cases_tab_button.click()}cases_search.addEventListener("keyup",search),cases_select.addEventListener("change",filter),cases_column_select.addEventListener("click",applyColumnChanges),cases_reset.addEventListener("click",resetTable),advanced_search.addEventListener("click",toggleCasesAdvancedSearch);